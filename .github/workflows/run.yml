name: Daily Channel Update
on:
  schedule:
    - cron: '0 4 * * *' # ÙŠØ¹Ù…Ù„ Ø§Ù„Ø³Ø§Ø¹Ø© 4 ÙØ¬Ø±Ø§Ù‹ Ø¨ØªÙˆÙ‚ÙŠØª ØºØ±ÙŠÙ†ØªØ´
  workflow_dispatch: # Ø²Ø± Ù„Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ

jobs:
  update-tv:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0 # Ù…Ù‡Ù… Ù„Ø¬Ù„Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙƒØ§Ù…Ù„
          
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          
      - name: Install Libraries
        run: |
          python -m pip install --upgrade pip
          pip install requests
          
      - name: Run Update Script
        run: python update.py
        
      - name: Commit & Push Changes
        run: |
          git config --global user.name 'Hamza TV Bot'
          git config --global user.email 'bot@hamza-tv.com'
          git add channels.json
          # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØªØºÙŠÙŠØ±Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸
          git diff --quiet && git diff --staged --quiet || (git commit -m "ğŸ“º ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠ" && git pull --rebase && git push)
